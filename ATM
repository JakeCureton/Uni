import sys

card = 1
account_balance = 40000

#Card variables
'''def ejectcard():
    print("Thank you for using this cashpoint.")
    sys.exit()

def wm():
    while card == False:
     print('Please insert your card to start.')'''

def verify_pin(pin):
    if pin == '1234':
        return True
    else:
        return False

def log_in():
    tries = 0
    while tries < 4:
        pin = input('Please Enter Your 4 Digit Pin: ')
        if verify_pin(pin):
            print("Pin accepted!")
            return True
        else:
            print("Invalid pin")
            tries += 1
    print("Too many incorrect tries. Could not log in.")
    return False

def deposit():
    global account_balance
    try:
        deposit_amount = float(input("Enter amount to deposit : \n"))
        balance = account_balance + deposit_amount
        print("You have just deposited £%.2f. \n Your new account balance is £%.2f.\n" %(deposit_amount, balance))
        account_balance = balance
    except ValueError:
        print("You have entered an invalid amount. Please try again...")
    main_menu()

def withdraw():
    global account_balance
    try:
        withdraw_amount = float(input("Enter amount to withdraw : \n"))
        if withdraw_amount > account_balance:
            print("You do not have enough funds. Please choose another amount. \n")
            withdraw()
        else:
            balance = account_balance - withdraw_amount
            print("You have withdrawn %.2f." %(withdraw_amount))
            account_balance = balance
            main_menu()
    except ValueError:
        print("You have entered an invalid amount. Please try again...")
        main_menu()

def printbalance():
    global account_balance
    print("Your current balance : %.2f" % account_balance)
    main_menu()

def main_menu():
    userchoice = input("\nPlease select an option: \n Deposit: D \n Withdraw: W \n Balance: B \n Exit: E \n").upper()
    if (userchoice == "D"):
        deposit()
    elif userchoice == "W":
      withdraw()
    elif userchoice == "B":
     printbalance()
    else:
        print("Thank you for using this cashpoint.")
        sys.exit()

def start_menu():
    print("Welcome to Jake's atm!")
    if log_in():
        main_menu()
    print("Your card has been collected for security purposes. Please contact branch to request a new card.")

start_menu()
